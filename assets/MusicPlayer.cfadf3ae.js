import{l as V,j as P,r as z,s as J}from"./element-plus.ffa3b174.js";import{_ as L,n as y,a as E}from"./index.99eec98a.js";import{d as M,r as F,W as S,V as C,o as x,c as B,a as s,u as d,K as j,a2 as K,Q as u,O as a,S as b,b1 as Q,b0 as R,_ as W}from"./@vue.0303ec2e.js";import"./@vueuse.a950c1ff.js";import"./dayjs.b9cd1035.js";import"./axios.6b3d3030.js";import"./@element-plus.90e88801.js";import"./@ctrl.2e36ce53.js";import"./lodash-es.bf1863bb.js";import"./escape-html.e5dfadb9.js";import"./@popperjs.da6c49cb.js";import"./normalize-wheel-es.1c4ac15a.js";import"./vuex.a1b43142.js";import"./vue-router.e6db8529.js";import"./mavon-editor.09f2d933.js";import"./vue.97e54053.js";const q=v=>(Q("data-v-5990b654"),v=v(),R(),v),w={class:"music"},G={id:"SongAudio"},H=["src"],X={class:"music-left"},Y=q(()=>s("div",{class:"music-left__head"},"\u6211\u7684\u6B4C\u5355",-1)),Z={class:"music-left__playlist",style:{"flex-basis":"100%"}},tt=["onClick","textContent"],et={class:"music-right"},ot={class:"music-right-info"},st={class:"music-right-info__cover"},it={class:"image-slot",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},lt={class:"music-right-info__desc"},nt=["textContent"],ut={class:"music-right-info__desc--detail"},ct={class:"music-right-info__desc__playing"},rt={class:"music-right-info__desc__playing--btn"},_t={class:"music-right-info__desc__playing--cover"},at={class:"image-slot",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},dt={class:"music-right-info__desc__playing--song"},gt=W(" \u6B63\u5728\u64AD\u653E\uFF1A "),pt=["textContent"],mt={class:"music-right-songs"},ft=M({setup(v){let $=F([]).value,g=F([{id:"",title:"",list_cover_url:"",created_time:"",songs:[{id:"",song_title:"",artist:"",album:"",time:"",cover_url:"",url:""}]}]).value,p=S({id:"",title:"\u65E0",created_time:"\u65E0",list_cover_url:"",songs:[]}),e=S({list_id:"",song_id:"",title:"\u65E0",cover_url:"",url:"",time:""}),_=F(!1).value,D=F(0).value;function k(o,r){if(typeof g[r].songs!="undefined"){p=g.find(t=>t.id===o);return}y.getSongs(o).then(t=>{console.log(`res: ${JSON.stringify(t)}`),t!==void 0&&(g[r].songs=[],t.playlist.tracks.forEach(i=>{g[r].songs.push({id:i.id,song_title:i.name,artist:c(i.ar),album:i.al.name,time:"",cover_url:i.al.picUrl,url:""})}),p=g.find(i=>i.id===o));function c(i){let l="";return i.forEach(n=>{l+=`${n.name} / `}),l.substring(0,l.length-3)}}).catch(t=>console.log(t))}async function I(o){console.log(o);let r=await y.getSongUrl(o.id);if(r!==null){o.url=r.url,e.url=r.url,e.song_id=o.id,e.title=o.song_title,e.cover_url=o.cover_url,e.list_id=p.id;let t=document.getElementById("SongAudio");t.load();let c=t.play();c!==void 0&&(console.log(`playing promise data: ${JSON.stringify(c)}`),c.then(()=>{console.log(`\u6B63\u5728\u64AD\u653E: ${e.url}`),_=!0}).catch(i=>E.error(i)))}else E.error("\u52A0\u8F7D\u6B4C\u66F2\u4FE1\u606F\u51FA\u9519\uFF0C\u672A\u627E\u5230\u8D44\u6E90")}function O(){if(!_&&e.url==="")return;let o=document.getElementById("SongAudio");if(_)console.log("\u97F3\u9891\u64AD\u653E\u4E2D\uFF0C\u5373\u5C06\u6682\u505C"),D=o.currentTime,console.log(D),o.pause(),_=!_;else{console.log("\u97F3\u9891\u672A\u64AD\u653E\uFF0C\u5373\u5C06\u5F00\u59CB\u64AD\u653E");let r=o.play();r!==void 0&&r.then(()=>{console.log("\u64AD\u653E\u6210\u529F"),_=!_}).catch(t=>{console.log(t),_=!1})}}function N(){if(e.url==="")return;let o=e.list_id,r=e.song_id,t=g.find(n=>n.id===o);console.log(`this.playing_info.list_id: ${o}`),console.log(`list is undefined? ${t===void 0}`);let c=t.songs.find(n=>n.id===r),i=t.songs.indexOf(c);console.log(`index: ${i}`);let l=(i+1)%t.songs.length;console.log(`next index: ${l}`),y.getSongUrl(t.songs[l].id).then(n=>{t.songs[l].url=n.url,e.list_id=o,e.song_id=t.songs[l].id,e.title=t.songs[l].song_title,e.cover_url=t.songs[l].cover_url,e.url=t.songs[l].url;let m=document.getElementById("SongAudio");m.load(),m.play().then(()=>{_=!0,console.log("\u64AD\u653E\u6210\u529F")}).catch(h=>{_=!1,console.log("\u64AD\u653E\u5931\u8D25\uFF1A"+h)})}).catch(n=>E.error(n))}function T(){if(e.url==="")return;let o=e.list_id,r=e.song_id,t=g.find(n=>n.id===o);console.log(`this.playing_info.list_id: ${o}`),console.log(`list is undefined? ${t===void 0}`);let c=t.songs.find(n=>n.id===r),i=t.songs.indexOf(c);console.log(`index: ${i}`);let l=i===0?t.songs.length-1:i-1;console.log(`next index: ${l}`),y.getSongUrl(t.songs[l].id).then(n=>{t.songs[l].url=n.url,e.list_id=o,e.song_id=t.songs[l].id,e.title=t.songs[l].song_title,e.cover_url=t.songs[l].cover_url,e.url=t.songs[l].url;let m=document.getElementById("SongAudio");m.load(),m.play().then(()=>{_=!0,console.log("\u64AD\u653E\u6210\u529F")}).catch(h=>{_=!1,console.log("\u64AD\u653E\u5931\u8D25\uFF1A"+h)})}).catch(n=>E.error(n))}return(o,r)=>{const t=C("picture-filled"),c=V,i=P,l=C("caret-left"),n=C("video-play"),m=C("caret-right"),f=z,h=J;return x(),B("div",w,[s("audio",G,[s("source",{src:d(e).url,type:"audio/mp3"},null,8,H)]),s("div",X,[Y,s("div",Z,[(x(!0),B(j,null,K(d($),(A,U)=>(x(),B("div",{class:"music-left__playlist--item",key:A.id,onClick:ht=>k(A.id,U),textContent:b(A.title)},null,8,tt))),128))])]),s("div",et,[s("div",ot,[s("div",st,[u(i,{src:d(p).list_cover_url,fit:"cover",class:"music-right-info__cover--playlist"},{error:a(()=>[s("div",it,[u(c,null,{default:a(()=>[u(t)]),_:1})])]),_:1},8,["src"])]),s("div",lt,[s("div",{class:"music-right-info__desc--title",textContent:b(d(p).title)},null,8,nt),s("div",ut,"\u6B4C\u5355\u521B\u5EFA\u4E8E\uFF1A"+b(d(p).created_time),1),s("div",ct,[s("div",rt,[s("button",{onClick:T},[u(c,{size:"20px"},{default:a(()=>[u(l)]),_:1})]),s("button",{onClick:O},[u(c,null,{default:a(()=>[u(n)]),_:1})]),s("button",{onClick:N},[u(c,null,{default:a(()=>[u(c,{size:"20px"},{default:a(()=>[u(m)]),_:1})]),_:1})])]),s("div",_t,[u(i,{src:d(e).cover_url,fit:"cover",class:"music-right-info__cover--playlist"},{error:a(()=>[s("div",at,[u(c,null,{default:a(()=>[u(t)]),_:1})])]),_:1},8,["src"])]),s("div",dt,[gt,s("div",{class:"music-right-info__desc__playing--song--title",textContent:b(d(e).title)},null,8,pt)])])])]),s("div",mt,[u(h,{data:d(p).songs,"highlight-current-row":!0,height:"100%",onRowDblclick:I,class:"music-right-songs__table"},{default:a(()=>[u(f,{prop:"song_title",label:"\u97F3\u4E50\u6807\u9898"}),u(f,{prop:"artist",label:"\u6B4C\u624B"}),u(f,{prop:"album",label:"\u4E13\u8F91"}),u(f,{prop:"time",label:"\u6B4C\u66F2\u65F6\u957F"})]),_:1},8,["data"])])])])}}});var Tt=L(ft,[["__scopeId","data-v-5990b654"]]);export{Tt as default};
